# 내용정리
---

## 자바에서의 쓰레드
- 클래스를 하나 수행하거나 WAS 를 기동하면, 서버에 자바 프로세스가 하나 생성된다.
- 하나의 프로세스에는 여러 개의 스레드가 생성된다.
- 프로세스와 스레드의 관계는 1:다 관계라고 볼 수 있다.


### Thread 클래스 상속과 Runnable 인터페이스 구현
- 스레드의 구현은 Thread 클래스를 상속받는 방법과 Runnalbe 인터페이스를 구현하는 방법 2가지가 있다.
- 기본적으로 Thread 클래스는 Runnable 인터페이스를 구현한 것이기 때문에 어느 것을 사용해도 거의 차이가 없다.
  - Runnalbe 인터페이스 구현의 경우 커스텀이 가능하다.
  - 그러나, 해당 클래스를 수행할 때 별도의 스레드 객체를 생성해야 하는 점은 단점이 될 수 있다.
- 자바는 다중 상속을 인정하지 않기 때문에 이미 상속받은 클래스가 있다면 Runnalbe 인터페이스를 구현해야 한다.

  public class RunThreads {
    public static void main(String []args) {
      RunnableImpl ri = new RunnableImpl();
      ThreadExtends te = new ThreadExtends();
      new Thread(ri).start();
      te.start();
    }
  }
  
실행할 때마다 결과 값이 고정되지 않는다. 스레드를 호출하면서 우선순위를 정하지 않았으므로 어떤 것이든 결과가 먼저 나올 수 있다.

### sleep(), watie(), join() 메서드
- 현재 진행 중인 스레드를 대기하도록 하기 위해 사용하는 메서드이다.
- 위의 세가지 메ㅓㅅ드는 모두 예외를 던지도록 되어있어 반드시 사용할 때 예외처리를 해주어야 한다.
  - wait() 메서드는 모든 클래스의 부모클래스인 Object 클래스에 선언되어 있으므로 어떤 클래스에서도 사용가능하다.
  - sleep() 메서드는 명시된 시간만큼 해당 스레드를 대기시키낟.
    - sleep(long millis) : 명시된 ms 만큼 해당 스레드가 대기한다.
    - sleep(long millis, int nanos) : 명시된 ms 만큼 해당 스레드가 대기한다.
  - join() 메서드는 명시된 시간만큼 해당 스레드가 죽기를 기다린다.

### interrupt(), notify(), notifyAll() 메서드
- 앞서 명시한 세 개의 메서드를 모두 멈출 수 있는 유일한 메서드는 interrupt() 메서드이다.
- interrupt() 메서드가 호출되면 중지된 스레드에는 InterruptedExceoptino 이 발생한다.
  - isInterrupted() 메서드는 단지 스레드의 상태를 리턴한다.
- interrupt() 메서드는 해당 스레드가 block 되거나 특정 상태에서만 작동한다.


### synchronized 를 이해하자.
- 하나의 객체에 여러 요청이 동시에 들어올 때 이상한 결과가 나올 수 있다. 이를 해결하기 위한 것이 synchronized 이다.
- synchronized 식별자만 쓰면 동기화할 수 있다.
- synchronized 를 사용하는 경우
  - 하나의 객체를 여러 스레드에서 동시에 사용할 경우
  - static 으로 선언한 객체를 여러 스레드에서 동시에 사용할 경우
- 동기화의 무분별한 사용은 성능을 저하시킨다.


### 동기화를 위해서 자바에서 제공하는 것들
- concurrent 패키지
  - Lock : 실행중인 스레드를 간단한 방법으로 정지시켰다가 실행시킨다. 상호 참조로 인해 발생하는 데드락을 피할 수 있다.
  - Executors : 스레드를 더 효율적으로 관리할 수 있는 클래스들을 제공한다. 스레드 풀도 제공하므로 필요에 따라 유용하게 사용할 수 있다.
  - Concurrent 콜렉션 : 앞서 살펴본 콜레겻ㄴ의 클래스들을 제공한다.
  - Atomic 변수 : 동기화가 되어 있는 변수를 제공한다. 이 변수를 사용하면 synchronized 식별자를 메서드에 지정할 필요 없이 사용할 수 있다.


### JVM 내에서 synchronization 은 어떠헥 동작할까?
- 자바의 HotSpot VM 은 자바 모니터(monitor) 를 제공함으로써 스레드들이 상호배제프로토콜에 참여할 수 있도록 돕는다.
- 자바 모니터는 잠긴 상태나 풀림 중 하나이며, 동일한 모니터에 진입한 여러 스레드들 중에서 한 시점에는 단 하나의 스레드만 모니터를 가질 수 있다.


# 느낀점
---

- synchronized 의 무분별한 사용을 지양해야겠다.
