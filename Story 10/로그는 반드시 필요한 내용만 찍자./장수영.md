# 10. 로그는 반드시 필요한 내용만 찍자

### System.out.println()의 문제점

---

- 시스템 로그를 프린트하면 성능에 영향을 준다.
- 콘솔에 로그를 남기는 경우를 생각해보면 내용이 프린트되거나 저장될 때까지 뒤에 프린트하려는 부분은 대기할 수 밖에 없어서, 애플리케이션에서 대기시간이 발생한다.
- 그리고 System.out.println()으로 출력하는 로그는 운영할 때는 볼 수 없기 때문에, 의미없는 디버그용 로그를 프린트하는데 서버의 리소스와 디스크를 낭비하게 된다.

### 로그를 더 간결하게 처리하는 방법

---

- 디버그용 로그가 꼭 필요한 경우 → Logger를 사용하자
    - Logger를 사용하기 어려운 경우라면?
        - 자체 로거 클래스를 만들어서 사용하는 방법 → 이미 만들어져 있는 Logger를 사용하는게 더 효율적이므로 비추천
        - 시스템 로그를 컴파일할 때 삭제되도록 하는 방법

### 로거 사용 시의 문제점

---

- 로그 프린트 여부에 상관없이 객체를 무조건 생성해야한다. → 객체를 생성하는 데 메모리와 시간이 소요되고, 메모리에서 객체를 제거하기 위해서는 GC도 수행되어야 하며 여기서 또 시간이 소요된다.

```java
logger.info("query=" + query);
logger.info("result=" + resultHashMap);
```

- 위와 같이 로그를 처리하면
    - `logger.info("query=" + query);` → info() 메서드가 호출이 될것이고, 호출되는 메서드에 문자열이 전달돼야하기 때문에 괄호 안의 값들을 문자열로 변환하는 작업이 반드시 수행된 다음, 메서드 호출이 진행된다.
    - `logger.info("result=" + resultHashMap);` → HashMap에 있는 모든 데이터를 확인 → 문자열로 더하는 작업 수행 → result= 문자열과 더하는 연산을 수행한다.
    
- 그러므로 위와 같은 경우에는 시스템 로그의 경우처럼 로그 처리 여부를 처리하는 것이 좋다.
    
    ```java
    if (logger.isLoggable(Level.INFO)) {
    	// 로그처리
    }
    ```
    
    - if 로 처리하면 로그를 위한 불필요한 메모리 사용을 줄일 수 있다.
    

### 로그를 깔끔하게 처리해주는 slf4j와 LogBack

---

- 로그를 처리해주는 프레임워크
- log4j와 차이점
    - 기존의 로거들 :  출력을 위해서 문자열을 더해서 전달해줘야 했음
    - slf4j는 format 문자열에 {}를 넣고 순서대로 출력하고자 하는 데이터들을 ,로 구분해서 전달. → 이렇게하면 로그를 출력하지 않을 경우 필요없는 문자열 더하기 연산이 발생하지 않는다.
    - slf4j는 자바의 기본로거, Log4j, 아파치 commons 로깅 등과 연계하여 사용할 수 있도록 되어 있다.
    

### 예외처리는 이렇게

---

`e.printStackTrace()` 를 호출하면 스택 정보를 확인하고, 정보를 콘솔에 찍는다. 자바의 예외 스택 정보는 로그를 최대 100개까지 프린트하기 때문에 서버의 성능에도 많은 부하를 준다. 

그러므로, prinStackTrace()에서 출력해주는 데이터가 필요한 경우에는 원하는 스택 정보를 가공해서 메세지를 처리하자.
